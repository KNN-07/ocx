name: Sync Background Agents

on:
  workflow_dispatch:
  push:
    branches:
      - main
    paths:
      - 'workers/kdco-registry/files/plugin/background-agents.ts'
      - 'facades/opencode-background-agents/**'

jobs:
  sync:
    if: github.repository == 'kdcokenny/ocx'
    uses: ./.github/workflows/_sync-facade.yml
    with:
      source_plugin_path: workers/kdco-registry/files/plugin/background-agents.ts
      target_plugin_path: src/plugin/background-agents.ts
      source_readme_path: facades/opencode-background-agents/README.md
      target_repo: kdcokenny/opencode-background-agents
      checkout_path: background-agents
    secrets: inherit
