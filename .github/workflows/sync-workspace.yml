name: Sync Workspace

on:
  workflow_dispatch:
  push:
    branches:
      - main
    paths:
      - 'workers/kdco-registry/files/plugin/workspace-plugin.ts'
      - 'facades/opencode-workspace/**'

jobs:
  sync:
    if: github.repository == 'kdcokenny/ocx'
    uses: ./.github/workflows/_sync-facade.yml
    with:
      source_plugin_path: workers/kdco-registry/files/plugin/workspace-plugin.ts
      target_plugin_path: src/plugin/workspace-plugin.ts
      source_readme_path: facades/opencode-workspace/README.md
      target_repo: kdcokenny/opencode-workspace
      checkout_path: workspace
    secrets: inherit
