name: Sync Worktree

on:
  workflow_dispatch:
  push:
    branches:
      - main
    paths:
      - 'workers/kdco-registry/files/plugin/worktree-plugin.ts'
      - 'facades/opencode-worktree/**'

jobs:
  sync:
    if: github.repository == 'kdcokenny/ocx'
    uses: ./.github/workflows/_sync-facade.yml
    with:
      source_plugin_path: workers/kdco-registry/files/plugin/worktree-plugin.ts
      target_plugin_path: src/plugin/worktree-plugin.ts
      source_readme_path: facades/opencode-worktree/README.md
      target_repo: kdcokenny/opencode-worktree
      checkout_path: worktree
    secrets: inherit
