{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"$id": "https://ocx.kdco.dev/lock.schema.json",
	"title": "OCX Lockfile Schema",
	"type": "object",
	"properties": {
		"lockVersion": {
			"type": "integer",
			"enum": [1],
			"description": "The version of the lockfile format"
		},
		"installed": {
			"type": "object",
			"description": "Map of installed components keyed by namespace/component",
			"propertyNames": {
				"pattern": "^[a-z0-9]+(-[a-z0-9]+)*/[a-z0-9]+(-[a-z0-9]+)*$"
			},
			"default": {},
			"additionalProperties": {
				"type": "object",
				"properties": {
					"registry": {
						"type": "string",
						"description": "The name of the registry this component was installed from"
					},
					"version": {
						"type": "string",
						"description": "The version of the component installed"
					},
					"hash": {
						"type": "string",
						"description": "SHA-256 hash of the actual file content for integrity verification. For multi-file components, this is a deterministic hash of the file bundle."
					},
					"files": {
						"type": "array",
						"items": { "type": "string" },
						"description": "Array of project-relative paths where the component files were installed"
					},
					"installedAt": {
						"type": "string",
						"description": "The timestamp when the component was installed (ISO format)"
					}
				},
				"required": ["registry", "version", "hash", "files", "installedAt"],
				"additionalProperties": false
			}
		}
	},
	"required": ["lockVersion", "installed"],
	"additionalProperties": false
}
